<div class="users-wrapper" (click)="isFilterOpen = false">
  <div class="users-container-list" [class.with-details]="isDetailsOpen">
    <div class="users-header">
      <h1 class="title">{{title}}</h1>
      <h2 class="subtitle">{{subtitle}}</h2>
    </div>
    <div class="filters-wrapper" (click)="$event.stopPropagation()">
      <app-search-input [placeholder]="inputSearch" class="input-search"
        (searchChange)="handleSearchChange($event)">
        <img src="assets/svg/icon/input/search.svg" alt />
      </app-search-input>
      <div class="filters-container">
        <button class="filters" (click)="toggleFiltersPopup()"><img
            src="assets/svg/icon/users/filters.svg">{{
          btnFilters }}</button>
        <!-- filters popup -->
        <div class="filters-popup" *ngIf="isFilterOpen"
          (click)="$event.stopPropagation()">
          <div class="menu-header">
            <button (click)="clearFilters()" class="clear-btn">Clear</button>
            <h1>Filter</h1>
            <button (click)="applyFilters()" class="apply-btn">Done</button>
          </div>
          <div class="menu-item">
            <!-- Filters layout as requested -->
            <div class="filter-section">
              <div class="section-title">Status</div>
              <label><input type="checkbox" /> Online</label>
              <label><input type="checkbox" /> Offline</label>
              <hr />
              <div class="section-title">Situation</div>
              <label><input type="checkbox" /> Ativo</label>
              <label><input type="checkbox" /> Bloqueado</label>
            </div>
            <hr />
            <div class="filter-section">
              <div class="section-title">Grupo</div>
              <label><input type="checkbox" /> Admin</label>
              <label><input type="checkbox" /> RH</label>
              <label><input type="checkbox" /> Financeiro</label>
            </div>
            <hr />
            <div class="filter-section">
              <div class="section-title">Último login</div>
              <label><input type="radio" name="lastLogin" /> Hoje</label>
              <label><input type="radio" name="lastLogin" /> 7 dias</label>
              <label><input type="radio" name="lastLogin" /> 30 dias</label>
              <label><input type="radio" name="lastLogin" /> Intervalo</label>
            </div>
            <hr />
            <div class="filter-section">
              <div class="section-title">Criado em</div>
              <input type="date" class="date-input" /> até <input type="date"
                class="date-input" />
            </div>
            <hr />
            <div class="filter-section">
              <div class="section-title">Dispositivo</div>
              <label><input type="checkbox" /> Windows</label>
              <label><input type="checkbox" /> Mac</label>
              <label><input type="checkbox" /> Mobile</label>
            </div>
          </div>
        </div>
      </div>
      <button class="export"><img src="assets/svg/icon/users/export.svg">{{
        btnExport }}</button>
      <div class="selected-count" *ngIf="currentSelectedCount > 0">
        {{ currentSelectedCount }} usuário(s) selecionado(s)
      </div>
    </div>
    <app-list-users [searchQuery]="currentSearchQuery"
      (selectedCount)="handleSelectedCount($event)"
      (selectedUsersEvent)="handleSelectedUsers($event)">>
    </app-list-users>

  </div>
  <div class="users-container-details" [class.active]="isDetailsOpen"
    *ngIf="selectedUser">
    <div class="users-header">
      <div class="line-header">
        <div class="title">Details user</div>
        <div class="close-icon" matTooltipPosition="above"
          matTooltip="Fechar Menu" (click)="closeDetailsPanel()">
          <img src="assets/svg/icon/input/clear.svg">
        </div>
      </div>

      <div class="user-info-wrapper">
        <img class="image-user" src="assets/user-photo.png" alt>
        <div class="user-info-text">
          <div class="user-line">
            <span class="name">{{ selectedUser.name }}</span>
            <app-situation-chip
              [blocked]="selectedUser.session?.blocked">
            </app-situation-chip>
          </div>
          <div class="email">{{ selectedUser.email }}</div>
        </div>
      </div>
      <div class="permissions-list">
        <app-group-chip [groups]="selectedUser.groups" [maxDisplay]="2"
          [allowExpand]="true">
        </app-group-chip>
      </div>
      <div class="phone-and-enrollment">
        <div class="phone">
          <img src="assets/svg/icon/users/phone.svg">
          {{ selectedUser.phone }}
        </div>
        <div class="enrollment">
          <img src="assets/svg/icon/users/document.svg">
          {{ selectedUser.enrollment }}
        </div>
      </div>
      <div class="divider"></div>
      <div class="permissions-container">
        <div class="title">Permissions</div>
        <div class="list-permissions">
          <div class="permission"
            *ngFor="let permission of permissionUserSelected">

            <img [matTooltip]="getCriticalText(permission.critical)"
              [matTooltipClass]="'tooltip'"
              matTooltipPosition="above"
              [src]="getSvgFileName(permission.critical)"
              class="critical-icon" />

            <span class="title" matTooltipPosition="above"
              [matTooltipClass]="'tooltip'"
              matTooltip="{{permission.title}}">{{ permission.title }}</span>

            <div class="extra-information">
              <div class="icon-wrapper" [matMenuTriggerFor]="detailsMenu">
                <img src="assets/svg/icon/register/step-2/extra_info.svg"
                  alt="Info" [matTooltip]="menuTooltip"
                  matTooltipPosition="above" />
              </div>

              <mat-menu #detailsMenu="matMenu" class="permission-details-menu">
                <div class="menu-content" (click)="$event.stopPropagation()">
                  <div class="menu-title">{{ permission.title }}</div>
                  <div class="menu-item">{{ permission.description }}</div>
                </div>
              </mat-menu>
            </div>

          </div>
        </div>
      </div>
      <div class="divider"></div>
      <div class="extra-info-container">
        <h2 class="title">Extra Information</h2>
        <p class="description">{{selectedUser.description}}</p>
      </div>

      <app-border-button label="Edit this account">
        <img src="assets/svg/icon/default/edit.svg" alt></app-border-button>
    </div>
  </div>
</div>
